<Window x:Class="quiztime.Views.EditQuizWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Quiz Bewerken"
        WindowState="Maximized"
        Background="#0F0F0F"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Kleuren - Dark Mode -->
        <SolidColorBrush x:Key="Primary" Color="#00D9FF"/>
        <SolidColorBrush x:Key="Accent" Color="#FF006E"/>
        <SolidColorBrush x:Key="Success" Color="#00FF88"/>
        <SolidColorBrush x:Key="Danger" Color="#FF3366"/>
        <SolidColorBrush x:Key="Surface" Color="#1A1A2E"/>
        <SolidColorBrush x:Key="BorderColor" Color="#2D2D44"/>
        <SolidColorBrush x:Key="TextMain" Color="#E0E0E8"/>
        <SolidColorBrush x:Key="TextMuted" Color="#A0A0B0"/>
        <DropShadowEffect x:Key="SoftShadow" Color="#000000" BlurRadius="10" Opacity="0.12" ShadowDepth="2"/>

        <!-- Fonts -->
        <FontFamily x:Key="AppFont">Segoe UI</FontFamily>

        <!-- TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="Background" Value="#2A2A3E"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#E0E0E8"/>
            <Setter Property="CaretBrush" Value="#00D9FF"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ScrollViewer x:Name="PART_ContentHost" Foreground="{TemplateBinding Foreground}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource Primary}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Buttons met afgeronde hoeken -->
        <Style TargetType="Button">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10 6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="70"/>
            <Setter Property="Background" Value="{StaticResource Primary}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.95"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.55"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Varianten -->
        <Style x:Key="AccentButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource Accent}"/>
        </Style>
        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource Danger}"/>
        </Style>

        <Style x:Key="ListItemCard" TargetType="Border">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="4"/>
        </Style>

        <!-- Local style for answer TextBoxes: use app theme colors but ensure readable text -->
        <Style x:Key="AnswerTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Foreground" Value="{StaticResource TextMain}"/>
            <Setter Property="CaretBrush" Value="{StaticResource Primary}"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- HEADER -->
        <Border DockPanel.Dock="Top" Height="70" Padding="20" Background="{StaticResource Primary}">
            <DockPanel>
                <TextBlock Text="Quiz Bewerken" Foreground="White" FontSize="22" FontWeight="Bold" DockPanel.Dock="Left"/>
                <TextBlock x:Name="QuizTitelLabel" Foreground="#DDD6FE" FontSize="14" Margin="20 0 0 0" DockPanel.Dock="Left"/>
            </DockPanel>
        </Border>

        <!-- FOOTER -->
        <Border DockPanel.Dock="Bottom" Height="70" Padding="0 15" Background="#FFFFFF" BorderBrush="{StaticResource BorderColor}" BorderThickness="1 0 0 0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button Content="Annuleren" Width="120" Background="#9CA3AF" Margin="0 0 15 0" Click="Cancel_Click"/>
                <Button Content="Opslaan" Width="140" Background="{StaticResource Success}" Click="SaveAndClose_Click"/>
            </StackPanel>
        </Border>

        <!-- MAIN -->
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="20">
            <StackPanel>
                <!-- Quiz Info -->
                <Border Background="{StaticResource Surface}" CornerRadius="12" Padding="8" Margin="0 0 0 8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="160"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Quizgegevens" Foreground="{StaticResource Primary}" FontSize="16" FontWeight="Bold" Margin="0 0 0 4"/>
                        </StackPanel>
                        <Border Grid.Column="1" Background="#F3F4F6" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="10" Padding="6">
                            <StackPanel HorizontalAlignment="Center">
                                <Image x:Name="VraagAfbeeldingPreview" Stretch="UniformToFill" Height="72" Width="104"/>
                                <StackPanel Orientation="Horizontal" Margin="0 6 0 0" HorizontalAlignment="Center">
                                    <Button Content="Browse" Height="28" Click="SelectFoto_Click" Margin="0 0 6 0" Padding="8 4"/>
                                    <Button Content="X" Style="{StaticResource DangerButton}" Height="28" Width="30" Click="RemoveFoto_Click"/>
                                </StackPanel>
                                <TextBlock x:Name="FotoPathLabel" FontSize="9" Foreground="{StaticResource TextMuted}" Text="Geen foto" TextAlignment="Center" Margin="0 4 0 0"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- Content -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                <!-- Left -->
                <Border Grid.Column="0" Background="{StaticResource Surface}" CornerRadius="12" Padding="18" Margin="0 0 15 0">
                    <StackPanel>
                        <TextBlock Text="Vragen" Foreground="{StaticResource Primary}" FontSize="16" FontWeight="Bold" Margin="0 0 0 12"/>
                        <TextBox x:Name="NaamBox" Height="32" Padding="8" Margin="0 0 0 10" FontSize="13" Style="{x:Null}" Foreground="#E0E0E8" CaretBrush="#00D9FF" Background="#2A2A3E" BorderBrush="#2D2D44" BorderThickness="1" FontFamily="Segoe UI"/>
                        <ListBox x:Name="VragenLijst" Background="#151520" BorderThickness="0" Padding="3" SelectionChanged="VragenLijst_SelectionChanged">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Style="{StaticResource ListItemCard}" Background="#252536" Padding="10" CornerRadius="6" Margin="0 2">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Tekst}" FontSize="12" Foreground="{StaticResource TextMain}" TextWrapping="Wrap" MaxHeight="40"/>
                                            <TextBlock Text="{Binding Antwoorden.Count, StringFormat='Antwoorden: {0}'}" FontSize="10" Foreground="{StaticResource TextMuted}" Margin="0 4 0 0"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <StackPanel Orientation="Horizontal" Margin="0 12 0 0">
                            <Button Content="+ Nieuwe" Style="{StaticResource AccentButton}" Click="AddVraag_Click" Padding="12 8" FontWeight="Bold" Margin="0 0 8 0"/>
                            <Button Content="– Verwijder" Style="{StaticResource DangerButton}" Click="RemoveVraag_Click" Padding="12 8" FontWeight="Bold"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Right -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Vraag -->
                    <Border Grid.Row="0" Background="{StaticResource Surface}" CornerRadius="12" Padding="18" Margin="0 0 0 12">
                        <StackPanel>
                            <TextBlock Text="Vraagtekst en Instellingen" Foreground="{StaticResource Primary}" FontSize="16" FontWeight="Bold" Margin="0 0 0 12"/>
                            <TextBox x:Name="VraagTekstBox" Height="90" TextWrapping="Wrap" AcceptsReturn="True" Padding="10" Margin="0 0 0 15" FontSize="13" Style="{x:Null}" Foreground="#E0E0E8" CaretBrush="#00D9FF" Background="#2A2A3E" BorderBrush="#2D2D44" BorderThickness="1" FontFamily="Segoe UI"/>
                            <TextBox x:Name="VraagDuratieBox" Height="36" Padding="10" FontSize="13" Style="{x:Null}" Foreground="#E0E0E8" CaretBrush="#00D9FF" Background="#2A2A3E" BorderBrush="#2D2D44" BorderThickness="1" FontFamily="Segoe UI"/>
                        </StackPanel>
                    </Border>

                    <!-- Antwoorden -->
                    <Border Grid.Row="1" Background="{StaticResource Surface}" CornerRadius="12" Padding="14">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <!-- Give the answers list the remaining space so up to 2 rows fit comfortably -->
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="Antwoorden" Foreground="{StaticResource Primary}" FontSize="16" FontWeight="Bold" Margin="0 0 0 12"/>

                            <ListBox x:Name="AntwoordenLijst"
                                     Grid.Row="1"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     SelectionMode="Single"
                                     Margin="0 0 0 12"
                                     VerticalAlignment="Stretch"
                                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <!-- Zorg dat ListBoxItem zelf niet focusable is, zodat child TextBox de focus krijgt -->
                                        <Setter Property="Focusable" Value="False"/>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Columns="2"/>
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                    <Border Style="{StaticResource ListItemCard}" 
                        Background="#252536" 
                        BorderBrush="{StaticResource BorderColor}" 
                        BorderThickness="1" 
                        CornerRadius="10" 
                        Margin="6" 
                        Padding="10" 
                        Height="160"
                        Width="500"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch">
                                            <StackPanel>
                                                <Grid Margin="0 0 0 8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBox Grid.Column="0"
                                                             Text="{Binding Tekst, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             Height="60"
                                                             Margin="0 0 6 0"
                                                             Padding="7"
                                                             FontSize="12"
                                                             TextWrapping="Wrap"
                                                             AcceptsReturn="True"
                                                             VerticalAlignment="Top"
                                                             VerticalScrollBarVisibility="Auto"
                                                             Focusable="True"
                                                             Style="{x:Null}"
                                                             Foreground="#E0E0E8"
                                                             CaretBrush="#00D9FF"
                                                             Background="#2A2A3E"
                                                             BorderBrush="#2D2D44"
                                                             BorderThickness="1"
                                                             FontFamily="Segoe UI"
                                                             PreviewMouseLeftButtonDown="AnswerTextBox_PreviewMouseLeftButtonDown"/>
                                                    <Button Grid.Column="1" Content="✕" Height="60" Width="28" Style="{StaticResource DangerButton}" Click="RemoveAntwoord_Click" Tag="{Binding Id}" VerticalAlignment="Top" FontSize="14"/>
                                                </Grid>
                                                <CheckBox IsChecked="{Binding IsCorrect}">
                                                    <TextBlock Text="Correct antwoord" FontSize="11" Foreground="{StaticResource TextMain}"/>
                                                </CheckBox>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <Border Grid.Row="2" BorderBrush="{StaticResource BorderColor}" BorderThickness="2" CornerRadius="10" Background="#252536" Padding="12" Margin="0 6 0 0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="NieuwAntwoordBox" Grid.Column="0" Height="36" Padding="10" Margin="0 0 10 0" FontSize="13" Style="{x:Null}" Foreground="#E0E0E8" CaretBrush="#00D9FF" Background="#2A2A3E" BorderBrush="#2D2D44" BorderThickness="1" FontFamily="Segoe UI"/>
                                    <CheckBox x:Name="NieuwAntwoordCorrectCheckbox" Grid.Column="1" VerticalAlignment="Center" Margin="0 0 15 0"/>
                                    <Button x:Name="AddAntwoordBtn" Grid.Column="2" Content="Toevoegen" Style="{StaticResource AccentButton}" Height="36" Padding="16 0" Click="AddAntwoord_Click" FontWeight="Bold" FontSize="12"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>
                </Grid>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</Window>
